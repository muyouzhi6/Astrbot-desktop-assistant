# ğŸ–¥ï¸ AstrBot æ¡Œé¢åŠ©æ‰‹å®¢æˆ·ç«¯

[![GitHub](https://img.shields.io/badge/GitHub-muyouzhi6-blue?logo=github)](https://github.com/muyouzhi6)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Python](https://img.shields.io/badge/Python-3.10+-blue.svg)](https://www.python.org/)
[![PySide6](https://img.shields.io/badge/PySide6-6.5+-green.svg)](https://www.qt.io/qt-for-python)

ä¸€ä¸ªç‹¬ç«‹è¿è¡Œçš„æ¡Œé¢æ‚¬æµ®çƒåŠ©æ‰‹ï¼Œé€šè¿‡ HTTP API è¿æ¥è¿œç¨‹ AstrBot æœåŠ¡å™¨ã€‚

> âš ï¸ **é‡è¦æç¤º**ï¼šæœ¬é¡¹ç›®éœ€è¦é…åˆ AstrBot æœåŠ¡ç«¯æ’ä»¶ä¸€èµ·ä½¿ç”¨ï¼
> 
> ğŸ‘‰ **é…å¥—æ’ä»¶**ï¼š[astrbot_plugin_desktop_assistant](https://github.com/muyouzhi6/astrbot_plugin_desktop_assistant)

## ğŸ¯ é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ˜¯ AstrBot æ¡Œé¢åŠ©æ‰‹çš„**å®¢æˆ·ç«¯éƒ¨åˆ†**ï¼Œæä¾›æ‚¬æµ®çƒç•Œé¢å’Œç”¨æˆ·äº¤äº’åŠŸèƒ½ã€‚

### æ¶æ„è¯´æ˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      ç”¨æˆ·æ¡Œé¢                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚           AstrBot æ¡Œé¢åŠ©æ‰‹å®¢æˆ·ç«¯ (æœ¬é¡¹ç›®)              â”‚   â”‚
â”‚  â”‚  â€¢ æ‚¬æµ®çƒç•Œé¢                                         â”‚   â”‚
â”‚  â”‚  â€¢ å¯¹è¯çª—å£                                          â”‚   â”‚
â”‚  â”‚  â€¢ æˆªå›¾åŠŸèƒ½                                          â”‚   â”‚
â”‚  â”‚  â€¢ ç³»ç»Ÿæ‰˜ç›˜                                          â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                           â”‚ HTTP API                        â”‚
â”‚                           â–¼                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚            AstrBot æœåŠ¡å™¨ + æ’ä»¶ (é…å¥—é¡¹ç›®)           â”‚   â”‚
â”‚  â”‚  â€¢ WebChat å¹³å°é€‚é…å™¨                                â”‚   â”‚
â”‚  â”‚  â€¢ æ¶ˆæ¯é˜Ÿåˆ—ç®¡ç†                                      â”‚   â”‚
â”‚  â”‚  â€¢ AI å¯¹è¯å¤„ç†                                       â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ”— **è¿œç¨‹è¿æ¥**: é€šè¿‡ HTTP API è¿æ¥äº‘ç«¯æˆ–æœ¬åœ° AstrBot æœåŠ¡å™¨
- ğŸ’¬ **å¯¹è¯äº¤äº’**: æ”¯æŒæ–‡æœ¬ã€å›¾ç‰‡ã€è¯­éŸ³æ¶ˆæ¯
- ğŸ–¼ï¸ **æˆªå›¾åŠŸèƒ½**: æˆªå–å±å¹•åŒºåŸŸå¹¶å‘é€ç»™ AI
- ğŸ”” **ç³»ç»Ÿæ‰˜ç›˜**: åå°è¿è¡Œï¼Œéšæ—¶å”¤èµ·
- âš¡ **æµå¼å“åº”**: æ”¯æŒ SSE æµå¼æ¶ˆæ¯æ˜¾ç¤º
- ğŸ”’ **å®‰å…¨è®¤è¯**: JWT Token è®¤è¯æœºåˆ¶
- ğŸ¨ **ä¸»é¢˜åˆ‡æ¢**: æ”¯æŒäº®è‰²/æš—è‰²/è·Ÿéšç³»ç»Ÿä¸»é¢˜
- ğŸš€ **å¼€æœºè‡ªå¯**: æ”¯æŒ Windows å¼€æœºè‡ªåŠ¨å¯åŠ¨
- ğŸ’¡ **æ¶ˆæ¯é€šçŸ¥**: æ‚¬æµ®çƒåŠ¨æ€æ•ˆæœæç¤ºæœªè¯»æ¶ˆæ¯

## ğŸ“¦ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£… AstrBot æœåŠ¡ç«¯æ’ä»¶

é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ AstrBot æœåŠ¡å™¨å·²å®‰è£…é…å¥—æ’ä»¶ï¼š

```bash
# åœ¨ AstrBot ä¸­å®‰è£…æ’ä»¶
# æ–¹å¼1: é€šè¿‡ AstrBot æ’ä»¶å¸‚åœºæœç´¢ "desktop_assistant"
# æ–¹å¼2: æ‰‹åŠ¨å…‹éš†åˆ°æ’ä»¶ç›®å½•
git clone https://github.com/muyouzhi6/astrbot_plugin_desktop_assistant.git \
    data/plugins/astrbot_plugin_desktop_assistant
```

### 2. å®‰è£…å®¢æˆ·ç«¯ä¾èµ–

```bash
# å…‹éš†æœ¬é¡¹ç›®
git clone https://github.com/muyouzhi6/Astrbot-desktop-assistant.git
cd Astrbot-desktop-assistant

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 3. å¯åŠ¨å®¢æˆ·ç«¯

```bash
# æ–¹å¼1: ä½œä¸ºæ¨¡å—è¿è¡Œ
python -m desktop_client

# æ–¹å¼2: ç›´æ¥è¿è¡Œ
python desktop_client/main.py
```

## ğŸ”§ é…ç½®è¯´æ˜

### å‘½ä»¤è¡Œå‚æ•°

```bash
python -m desktop_client [é€‰é¡¹]

é€‰é¡¹:
  -c, --config PATH     é…ç½®æ–‡ä»¶è·¯å¾„ (é»˜è®¤: ~/.astrbot_client/config.json)
  -s, --server URL      æœåŠ¡å™¨ URL (å¦‚ http://localhost:6185)
  -u, --username NAME   ç™»å½•ç”¨æˆ·å
```

### é…ç½®æ–‡ä»¶

é…ç½®æ–‡ä»¶ä¸º JSON æ ¼å¼ï¼Œé»˜è®¤ä½ç½®: `~/.astrbot_client/config.json`

```json
{
  "server": {
    "url": "http://localhost:6185",
    "username": "astrbot",
    "password": "",
    "token": null,
    "auto_reconnect": true,
    "reconnect_interval": 5.0,
    "request_timeout": 30.0
  },
  "appearance": {
    "theme": "auto",
    "opacity": 0.95,
    "always_on_top": true
  },
  "chat_window": {
    "width": 400,
    "height": 600,
    "font_size": 14,
    "show_timestamp": true
  },
  "voice": {
    "enabled": true,
    "auto_send": true,
    "sample_rate": 16000
  },
  "autostart": {
    "enabled": false
  },
  "session_id": null
}
```

### é…ç½®é¡¹è¯´æ˜

| é…ç½®é¡¹ | è¯´æ˜ | é»˜è®¤å€¼ |
|-------|------|--------|
| `server.url` | AstrBot æœåŠ¡å™¨åœ°å€ | `http://localhost:6185` |
| `server.username` | ç™»å½•ç”¨æˆ·å | `astrbot` |
| `server.password` | ç™»å½•å¯†ç  | ç©º |
| `server.auto_reconnect` | è‡ªåŠ¨é‡è¿ | true |
| `appearance.theme` | ä¸»é¢˜ (light/dark/auto) | auto |
| `appearance.opacity` | çª—å£é€æ˜åº¦ | 0.95 |
| `autostart.enabled` | å¼€æœºè‡ªå¯åŠ¨ | false |

## ğŸ® ä½¿ç”¨æŒ‡å—

### åŸºæœ¬æ“ä½œ

| æ“ä½œ | è¯´æ˜ |
|------|------|
| å•å‡»æ‚¬æµ®çƒ | æ˜¾ç¤º/éšè—æ°”æ³¡æ¶ˆæ¯ |
| åŒå‡»æ‚¬æµ®çƒ | æ‰“å¼€å¯¹è¯çª—å£ |
| å³é”®æ‚¬æµ®çƒ | æ˜¾ç¤ºåŠŸèƒ½èœå• |
| æ‹–æ‹½æ‚¬æµ®çƒ | ç§»åŠ¨ä½ç½® |

### å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `Enter` | å‘é€æ¶ˆæ¯ |
| `Shift + Enter` | æ¶ˆæ¯æ¢è¡Œ |
| `Ctrl + V` | ç²˜è´´å›¾ç‰‡ |
| `Esc` | å…³é—­å¯¹è¯çª—å£ |

### å›¾ç‰‡é¢„è§ˆ

å¯¹è¯çª—å£å’Œæ°”æ³¡æ¶ˆæ¯ä¸­çš„å›¾ç‰‡æ”¯æŒï¼š
- ç‚¹å‡»ç¼©ç•¥å›¾æŸ¥çœ‹å¤§å›¾
- æ»šè½®ç¼©æ”¾
- æ‹–æ‹½ç§»åŠ¨
- å¤åˆ¶åˆ°å‰ªè´´æ¿
- ä¸‹è½½ä¿å­˜

## ğŸ“ ç›®å½•ç»“æ„

```
desktop_client/
â”œâ”€â”€ __init__.py          # åŒ…åˆå§‹åŒ–
â”œâ”€â”€ __main__.py          # æ”¯æŒ python -m è¿è¡Œ
â”œâ”€â”€ main.py              # åº”ç”¨å…¥å£
â”œâ”€â”€ app.py               # åº”ç”¨ä¸»ç±»
â”œâ”€â”€ config.py            # é…ç½®ç®¡ç†
â”œâ”€â”€ api_client.py        # HTTP API å®¢æˆ·ç«¯
â”œâ”€â”€ bridge.py            # æ¶ˆæ¯æ¡¥æ¥å™¨
â”œâ”€â”€ requirements.txt     # ä¾èµ–åˆ—è¡¨
â”œâ”€â”€ gui/                 # GUI ç»„ä»¶
â”‚   â”œâ”€â”€ floating_ball.py # æ‚¬æµ®çƒ
â”‚   â”œâ”€â”€ simple_chat_window.py # å¯¹è¯çª—å£
â”‚   â”œâ”€â”€ settings_window.py # è®¾ç½®çª—å£
â”‚   â”œâ”€â”€ system_tray.py   # ç³»ç»Ÿæ‰˜ç›˜
â”‚   â”œâ”€â”€ screenshot_selector.py # æˆªå›¾é€‰æ‹©å™¨
â”‚   â”œâ”€â”€ markdown_utils.py # Markdown æ¸²æŸ“
â”‚   â”œâ”€â”€ themes.py        # ä¸»é¢˜ç®¡ç†
â”‚   â””â”€â”€ hotkeys.py       # å¿«æ·é”®
â”œâ”€â”€ services/            # åå°æœåŠ¡
â”‚   â”œâ”€â”€ screen_capture.py # æˆªå›¾æœåŠ¡
â”‚   â””â”€â”€ proactive_dialog.py # ä¸»åŠ¨å¯¹è¯
â””â”€â”€ utils/               # å·¥å…·æ¨¡å—
    â””â”€â”€ autostart.py     # å¼€æœºè‡ªå¯åŠ¨
```

## â“ æ•…éšœæ’é™¤

### è¿æ¥å¤±è´¥

1. ç¡®è®¤ AstrBot æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥æœåŠ¡å™¨åœ°å€æ˜¯å¦æ­£ç¡®
3. ç¡®è®¤å·²å®‰è£…é…å¥—æ’ä»¶
4. æ£€æŸ¥ç”¨æˆ·åå¯†ç æ˜¯å¦æ­£ç¡®
5. ç¡®è®¤é˜²ç«å¢™æœªé˜»æ­¢è¿æ¥

### SSE å“åº”å¼‚å¸¸

1. æ£€æŸ¥ç½‘ç»œç¨³å®šæ€§
2. å¢åŠ  `request_timeout` é…ç½®
3. æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—

### GUI æ— æ³•å¯åŠ¨

1. ç¡®è®¤å·²å®‰è£… PySide6: `pip install PySide6`
2. æ£€æŸ¥æ˜¾ç¤ºé©±åŠ¨

### å¼€æœºè‡ªå¯åŠ¨ä¸å·¥ä½œ

1. ç¡®è®¤è®¾ç½®ä¸­å·²å¯ç”¨å¼€æœºè‡ªå¯åŠ¨
2. æ£€æŸ¥ Windows å¯åŠ¨é¡¹è®¾ç½®

## ğŸ“„ ä¾èµ–

| ä¾èµ– | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| PySide6 | â‰¥6.5.0 | Qt6 GUI æ¡†æ¶ |
| httpx | â‰¥0.24.0 | å¼‚æ­¥ HTTP å®¢æˆ·ç«¯ |
| mss | â‰¥9.0.0 | æˆªå›¾æœåŠ¡ |
| Pillow | â‰¥10.0.0 | å›¾åƒå¤„ç† |
| pyaudio | â‰¥0.2.13 | éŸ³é¢‘å½•åˆ¶ (å¯é€‰) |

## ğŸ”— ç›¸å…³é“¾æ¥

- **é…å¥—æ’ä»¶**: [astrbot_plugin_desktop_assistant](https://github.com/muyouzhi6/astrbot_plugin_desktop_assistant)
- **AstrBot**: [https://github.com/Soulter/AstrBot](https://github.com/Soulter/AstrBot)
- **ä½œè€…ä¸»é¡µ**: [https://github.com/muyouzhi6](https://github.com/muyouzhi6)

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ™ è‡´è°¢

- [AstrBot](https://github.com/Soulter/AstrBot) - å¼ºå¤§çš„ AI èŠå¤©æœºå™¨äººæ¡†æ¶
- [PySide6](https://www.qt.io/qt-for-python) - ä¼˜ç§€çš„ Python GUI æ¡†æ¶